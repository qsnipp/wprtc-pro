var $=jQuery,room=$(".localVideo").data("room"),localSrc="",wprtc_comm;maxCap=15,$(".localVideo").data("capacity")&&(maxCap=$(".localVideo").data("capacity")),$(document).ready(function(o){return wprtc_info.wprtc_icecomm?(wprtc_comm=new Icecomm(wprtc_info.wprtc_icecomm,{debug:!0}),room=room.trim(),"none"==room?o("#wprtc_splash").show():(o(".rtcVideoContainer").show(),wprtc_comm.connect(room,{audio:!0,limit:parseInt(maxCap)},function(){console.log("connected to: "+room)})),wprtc_comm.on("connected",function(o){console.log("Joining Room (Remote)"),console.log(wprtc_comm.getRoomSize(),wprtc_comm.getRemoteIDs()),document.getElementById("remoteVideos").appendChild(o.getVideo())}),wprtc_comm.on("local",function(t){console.log("Joining Room (Local)"),console.log(wprtc_comm.getRooms(),wprtc_comm.getRoomSize(),wprtc_comm.getRemoteIDs()),o(".localVideo").get(0).src=t.stream,o(".localVideo").attr("id",t.id)}),wprtc_comm.on("disconnect",function(o){console.log("Leaving Room"),document.getElementById(o.ID).remove()}),o("#roomChange select").on("change",function(t){return room=o(this).val(),"-1"==room||-1==room?!1:(console.log("changing rooms: "+room),wprtc_comm.connect(room),void(o(".videoTitle").length&&o(".videoTitle").html(room)))}),o("body").on("click","#remoteVideos video",function(t){o(".mute_controls a").hide();var e=o(this).attr("src"),c=o(this).attr("id"),n=o(".localVideo").attr("src");o(".localVideo").attr("src",e),o(".localVideo").get(0).play(),o(this).attr("src",n),document.getElementById(c).play()}),o("body").on("click",".mute",function(t){t.preventDefault();var e=o(".localVideo").get(0);o(this).hasClass("audio")?(o(this).children("span.fa").toggleClass("fa-microphone").toggleClass("fa-microphone-slash"),console.log(wprtc_comm.getLocalID()),e.muted=e.muted?!1:!0):(o(this).children("span.fa").hasClass("on")?wprtc_comm.close():wprtc_comm.connect(room,{audio:e.muted,limit:parseInt(maxCap)},function(){console.log("reconnected to: "+room)}),o(this).children("span.fa").toggleClass("on").toggleClass("off"))}),void o("body").on("click","#startChat",function(t){t.preventDefault();var e=o(this).data("room");o("#wprtc_splash").hide(),o(".rtcVideoContainer").show(),o(".videoTitle").length&&o(".videoTitle").html(e),wprtc_comm.connect(e,{limit:parseInt(maxCap)},function(){console.log("connected to: "+e)})})):(alert("No API Key setup, please go to your admin settings to put in the Icecomm.io API key"),!1)});